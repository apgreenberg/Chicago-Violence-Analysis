<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
<style> /* set the CSS */

.line {
  fill: none;
  stroke-width: 3px;
}

#policeLine {
  stroke: steelblue;
}
#violentLine {
  stroke: red;
}
#otherLine {
  stroke: #ff4f2a;
}
#socialLine {
  stroke: darkTurquoise;
}

#homicideLine {
  stroke: #990000;
}
#rapeLine {
  stroke: #cc0000;
}
#robberyLine {
  stroke: #ff8080;
}
#burglaryLine {
  stroke: #ff4d4d;
}
#assaultLine {
  stroke: #ff0000;
}
#crimdamLine {
  stroke: #cc5200;
}
#narcLine {
  stroke: #993d00;
}
</style>
</head>
<body>
<h1>
  Click on a line to get more details
</h1>
<p id="topChartLineLabel">No Line Selected<p>

<!-- load the d3.js library -->    	
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

var secondGraphLoaded = 0;

var titleMapping = new Map();
titleMapping.set('#policeLine', {desc:"police funding for investigations, foot patrol, and internal review"});
titleMapping.set('#violentLine', {desc:"crimes rates in homicide, rape, robbery, burglary, and battery"});
titleMapping.set('#otherLine', {desc:"crime rates of narcotics and criminal damage"});
titleMapping.set('#socialLine', {desc:"city spending on social programs"});
titleMapping.set('#homicideLine', {desc:"homocides"});
titleMapping.set('#rapeLine', {desc:"rapes"});
titleMapping.set('#robberyLine', {desc:"robberies"});
titleMapping.set('#burglaryLine', {desc:"burglaries"});
titleMapping.set('#assaultLine', {desc:"assault/battery"});
titleMapping.set('#narcoticsLine', {desc:"narcotics"});
titleMapping.set('#crimdamageLine', {desc:"crinimal damage"});
//hover over police line
function highlight(id) {
  d3.selectAll('.line')
  .style("stroke", "gainsboro");
  d3.select(id)
  .style("stroke", "black")
  .style("stroke-width", "6px");
  //.append("text")
  //.text(titleMapping.get(id).desc);
  d3.select("#topChartLineLabel")
  .text(titleMapping.get(id).desc);
}

function dehighlight() {
  d3.selectAll('.line')
  .style("stroke", null)
  .style("stroke-width", null);
  d3.select("#topChartLineLabel")
  .text('No Line Selected');
}
function policefundgraph() {
  if (secondGraphLoaded == 1) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
    secondGraphLoaded = 0;
    return;
  }
  if (secondGraphLoaded != 0) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
  }
  secondGraphLoaded = 1;
  
}
function violentcrimegraph() {
if (secondGraphLoaded == 2) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
    secondGraphLoaded = 0;
    return;
  }
  if (secondGraphLoaded != 0) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
  }
  secondGraphLoaded = 2;
var homicideline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.homicide); });

// define the 2nd line
var rapeline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.rape); });

var robberyline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.robbery); });

var burglaryline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.burglary); });

var assaultline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.assault); });

  var brk = d3.select("body").append("br")
  var svg = d3.select("body").append("svg")
    .attr("class", "secondaryGraph")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

// Get the data
d3.csv("violentcrimestimeline.csv", function(error, data) {
  if (error) throw error;

  // format the data
  data.forEach(function(d) {
      d.year = parseTime(d.year);
      d.homicide = +d.homicide;
      d.rape = +d.rape;
      d.robbery = +d.robbery;
      d.burglary = +d.burglary;
      d.assault = +d.assault;
  });

  // Scale the range of the data
  x.domain(d3.extent(data, function(d) { return d.year; }));
  y.domain([d3.min(data, function(d) {
    return Math.min(d.homicide, d.rape, d.robbery, d.burglary, d.assault); }), d3.max(data, function(d) {
    return Math.max(d.homicide, d.rape, d.robbery, d.burglary, d.assault); })]);

  svg.append("text")
    .attr("x", width/2)
    .attr("y", height+35)
    .style("text-anchor", "middle")
    .text("Year");

   svg.append("text")
    .attr("x", -70)
    .attr("y", 15)
    .attr("transform", "rotate(-90)")
    .style("text-anchor", "middle")
    .text("% change since previous year");
  // Add the valueline path.
  svg.append("path")
      .data([data])
      .attr("id", "homicideLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#homicideLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("d", homicideline);

  // Add the valueline2 path.
  svg.append("path")
      .data([data])
      .attr("id", "rapeLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#rapeLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("onclick", "violentcrimegraph()")
      .attr("d", rapeline);

  svg.append("path")
      .data([data])
      .attr("id", "robberyLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#robberyLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("d", robberyline);

  svg.append("path")
      .data([data])
      .attr("id", "burglaryLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#burglaryLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("d", burglaryline);

   svg.append("path")
      .data([data])
      .attr("id", "assaultLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#assaultLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("d", assaultline);

  svg.append("path")
      .attr("d", "M 0 277 l 860 0")
      .style("stroke", "black");
  // Add the X Axis
  svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

  // Add the Y Axis
  svg.append("g")
      .call(d3.axisLeft(y));
});
}
function othercrimegraph() {
  if (secondGraphLoaded == 3) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
    secondGraphLoaded = 0;
    return;
  }
  if (secondGraphLoaded != 0) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
  }
  secondGraphLoaded = 3;
  var crimdamline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.crimdam); });

// define the 2nd line
  var narcline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.narc); });

  var brk = d3.select("body").append("br")
  var svg = d3.select("body").append("svg")
    .attr("class", "secondaryGraph")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

// Get the data
d3.csv("othercrimestimeline.csv", function(error, data) {
  if (error) throw error;

  // format the data
  data.forEach(function(d) {
      d.year = parseTime(d.year);
      d.crimdam = +d.crimdam;
      d.narc = +d.narc;
  });

  // Scale the range of the data
  x.domain(d3.extent(data, function(d) { return d.year; }));
  y.domain([d3.min(data, function(d) {
    return Math.min(d.crimdam, d.narc); }), d3.max(data, function(d) {
    return Math.max(d.crimdam, d.narc); })]);

  svg.append("text")
    .attr("x", width/2)
    .attr("y", height+35)
    .style("text-anchor", "middle")
    .text("Year");

   svg.append("text")
    .attr("x", -70)
    .attr("y", 15)
    .attr("transform", "rotate(-90)")
    .style("text-anchor", "middle")
    .text("% change since previous year");
  // Add the valueline path.
  svg.append("path")
      .data([data])
      .attr("id", "crimdamLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#crimdamLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("d", crimdamline);

  // Add the valueline2 path.
  svg.append("path")
      .data([data])
      .attr("id", "narcLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#narcLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("onclick", "violentcrimegraph()")
      .attr("d", narcline);

  svg.append("path")
      .attr("d", "M 0 277 l 860 0")
      .style("stroke", "black");
  // Add the X Axis
  svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

  // Add the Y Axis
  svg.append("g")
      .call(d3.axisLeft(y));
  });
}
function socialproggraph() {
  if (secondGraphLoaded == 4) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
    secondGraphLoaded = 0;
    return;
  }
  if (secondGraphLoaded != 0) {
    var toHide = d3.selectAll(".secondaryGraph")
    .style("display", "none");
  }
  secondGraphLoaded = 4;
}

// set the dimensions and margins of the graph
var margin = {top: 50, right: 50, bottom: 50, left: 50},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

// parse the date / time
var parseTime = d3.timeParse("%Y");

// set the ranges
var x = d3.scaleTime().range([0, width]);
var y = d3.scaleLinear().range([height, 0]);

// define the 1st line
var policeline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.police); });

// define the 2nd line
var violentline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.violent); });

var otherline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.other); });

var socialline = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.social); });

// append the svg obgect to the body of the page
// appends a 'group' element to 'svg'
// moves the 'group' element to the top left margin
var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

// Get the data
d3.csv("crimetimeline.csv", function(error, data) {
  if (error) throw error;

  // format the data
  data.forEach(function(d) {
      d.year = parseTime(d.year);
      d.police = +d.police;
      d.violent = +d.violent;
      d.other = +d.other;
      d.social = +d.social;
  });

  // Scale the range of the data
  x.domain(d3.extent(data, function(d) { return d.year; }));
  y.domain([d3.min(data, function(d) {
    return Math.min(d.police, d.violent, d.other, d.social); }), d3.max(data, function(d) {
	  return Math.max(d.police, d.violent, d.other, d.social); })]);

  svg.append("text")
    .attr("x", width/2)
    .attr("y", height+35)
    .style("text-anchor", "middle")
    .text("Year");

   svg.append("text")
    .attr("x", -70)
    .attr("y", 15)
    .attr("transform", "rotate(-90)")
    .style("text-anchor", "middle")
    .text("% change since previous year");
  // Add the valueline path.
  svg.append("path")
      .data([data])
      .attr("id", "policeLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#policeLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("onclick", "policefundgraph()")
      .attr("d", policeline);

  // Add the valueline2 path.
  svg.append("path")
      .data([data])
      .attr("id", "violentLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#violentLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("onclick", "violentcrimegraph()")
      .attr("d", violentline);

  svg.append("path")
      .data([data])
      .attr("id", "otherLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#otherLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("onclick", "othercrimegraph()")
      .attr("d", otherline);

  svg.append("path")
      .data([data])
      .attr("id", "socialLine")
      .attr("class", "line")
      .attr("onmouseover", "highlight('#socialLine')")
      .attr("onmouseout", "dehighlight()")
      .attr("onclick", "socialproggraph()")
      .attr("d", socialline);

  svg.append("path")
      .attr("d", "M 0 213 l 860 0")
      .style("stroke", "black");
  // Add the X Axis
  svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

  // Add the Y Axis
  svg.append("g")
      .call(d3.axisLeft(y));

});

</script>
</body>
</html>